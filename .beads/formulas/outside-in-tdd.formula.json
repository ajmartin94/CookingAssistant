{
  "formula": "outside-in-tdd",
  "description": "Outside-in TDD workflow for a user story. E2E test defines acceptance, backend/frontend implement to pass it.",
  "version": 1,
  "type": "workflow",
  "vars": {
    "story": {
      "required": true,
      "description": "User story name (e.g., 'User creates recipe via chat')"
    },
    "e2e_outcome": {
      "required": true,
      "description": "What the E2E test verifies (e.g., 'Recipe exists in DB after approval')"
    }
  },
  "steps": [
    {
      "id": "e2e-red",
      "title": "[e2e-red] {{story}} - E2E test design",
      "type": "task",
      "description": "Design E2E tests verifying user outcomes. Acceptance: E2E test verifies {{e2e_outcome}}"
    },
    {
      "id": "backend-red",
      "title": "[backend-red] {{story}} - Backend test design",
      "type": "task",
      "description": "Design backend tests for API/service layer",
      "depends_on": ["e2e-red"]
    },
    {
      "id": "backend-green",
      "title": "[backend-green] {{story}} - Backend implementation",
      "type": "task",
      "description": "Implement backend code to pass tests",
      "depends_on": ["backend-red"]
    },
    {
      "id": "frontend-red",
      "title": "[frontend-red] {{story}} - Frontend test design",
      "type": "task",
      "description": "Design frontend tests for UI components",
      "depends_on": ["e2e-red"]
    },
    {
      "id": "frontend-green",
      "title": "[frontend-green] {{story}} - Frontend implementation",
      "type": "task",
      "description": "Implement frontend code to pass tests",
      "depends_on": ["frontend-red"]
    },
    {
      "id": "e2e-green",
      "title": "[e2e-green] {{story}} - E2E verification",
      "type": "task",
      "description": "Verify E2E test passes after implementation. Acceptance: E2E test passes",
      "depends_on": ["backend-green", "frontend-green"]
    }
  ]
}
