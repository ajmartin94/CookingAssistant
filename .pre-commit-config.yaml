# Pre-commit configuration
# Per AD-0101: Optional local hooks for fast feedback
#
# Setup:
#   pip install pre-commit
#   pre-commit install
#
# Usage:
#   pre-commit run --all-files  # Run on all files
#   git commit                  # Runs automatically on staged files
#   git commit --no-verify      # Skip hooks (use sparingly)
#
# Note: These hooks are OPTIONAL. CI enforcement is the authoritative gate.

repos:
  # Backend hooks (Python)
  - repo: local
    hooks:
      - id: backend-ruff
        name: Backend lint (ruff)
        entry: bash -c 'cd backend && source venv/bin/activate && ruff check --fix .'
        language: system
        types: [python]
        files: ^backend/
        pass_filenames: false

      - id: backend-black
        name: Backend format (black)
        entry: bash -c 'cd backend && source venv/bin/activate && black --check .'
        language: system
        types: [python]
        files: ^backend/
        pass_filenames: false

  # Frontend hooks (TypeScript/JavaScript)
  - repo: local
    hooks:
      - id: frontend-eslint
        name: Frontend lint (eslint)
        entry: bash -c 'cd frontend && npm run lint'
        language: system
        files: ^frontend/.*\.(ts|tsx|js|jsx)$
        pass_filenames: false

      - id: frontend-typecheck
        name: Frontend typecheck (tsc)
        entry: bash -c 'cd frontend && npx tsc -b'
        language: system
        files: ^frontend/.*\.(ts|tsx)$
        pass_filenames: false

      - id: frontend-stylelint
        name: Frontend lint CSS (stylelint)
        entry: bash -c 'cd frontend && npm run lint:css'
        language: system
        files: ^frontend/.*\.css$
        pass_filenames: false

      - id: frontend-prettier
        name: Frontend format (prettier)
        entry: bash -c 'cd frontend && npx prettier --check "src/**/*.{ts,tsx,css}"'
        language: system
        files: ^frontend/.*\.(ts|tsx|js|jsx|css)$
        pass_filenames: false
